!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.SpriteSpin={})}(this,function(e){"use strict";var r=function(e){this.data=e};function a(e){var t,n=r.prototype;for(t in e)if(e.hasOwnProperty(t)){if(n[t])throw new Error("API method is already defined: "+t);n[t]=e[t]}return n}var s,m,f,d=window.jQuery||window.$;function g(e){var t=e.touches,n=e;return{x:(n=void 0!==(t=void 0===e.touches&&void 0!==e.originalEvent?e.originalEvent.touches:t)&&0<t.length?t[0]:n).clientX||0,y:n.clientY||0}}function p(e,t,n){if(!(m||(s=s||document.createElement("canvas"))&&s.getContext&&(m=s.getContext("2d"))))return!1;if(t*n<=1048576)return!1;s.width=s.height=1,m.fillStyle="#FF00FF",m.fillRect(0,0,1,1),m.drawImage(e,1-t,0);try{var a=m.getImageData(0,0,1,1).data;return 255===a[0]&&0===a[1]&&255===a[2]}catch(e){return!1}}function v(e){var t=Math.floor(e.width||e.frameWidth||e.target.innerWidth()),e=Math.floor(e.height||e.frameHeight||e.target.innerHeight());return{aspect:t/e,height:e,width:t}}function w(e){var t=v(e);if("function"!=typeof window.getComputedStyle)return t;e=window.getComputedStyle(e.target[0]);return e.width&&(t.width=Math.floor(Number(e.width.replace("px",""))),t.height=Math.floor(t.width/t.aspect)),t}function b(e){var t=Math.floor(e.frameWidth||e.width||e.target.innerWidth()),e=Math.floor(e.frameHeight||e.height||e.target.innerHeight());return{aspect:t/e,height:e,width:t}}function x(e,t,n){var a="fit"===e,r="fill"===e,i={width:"100%",height:"100%",top:0,left:0,bottom:0,right:0,position:"absolute",overflow:"hidden"};if(!e||"stretch"===e)return i;var e=t.aspect>=n.aspect,o=t.width,s=t.height;return(a&&e||r&&!e)&&(o=n.width,s=n.width/t.aspect),(r&&e||a&&!e)&&(s=n.height,o=n.height*t.aspect),o=Math.floor(o),s=Math.floor(s),i.width=o,i.height=s,i.top=Math.floor((n.height-s)/2),i.left=Math.floor((n.width-o)/2),i.right=i.left,i.bottom=i.top,i}function y(e){return e.naturalWidth?{height:e.naturalHeight,width:e.naturalWidth}:((f=f||new Image).crossOrigin=e.crossOrigin,f.src=e.src,{height:f.height,width:f.width})}function S(e,t){if(1===e.length)return[k(e[0],t)];if(t.framesX&&t.framesY){for(var n=e,a=t,r=[],i=0;i<n.length;i++){var o=k(n[i],{frames:void 0,framesX:a.framesX,framesY:a.framesY,detectSubsampling:a.detectSubsampling});o.id=i,r.push(o)}return r}for(var s=e,c=t,l=[],u=0;u<s.length;u++){var d=k(s[u],{frames:1,framesX:1,detectSubsampling:c.detectSubsampling});d.id=u,l.push(d)}return l}function k(e,t){for(var n,a,r={id:0,sprites:[]},i=(s=t,n=r,a=y(e=e),n.isSubsampled=s.detectSubsampling&&p(e,a.width,a.height),n.width=a.width,n.height=a.height,n.sampledWidth=a.width/(n.isSubsampled?2:1),n.sampledHeight=a.height/(n.isSubsampled?2:1),t.frames),o=Number(t.framesX)||i,s=Math.ceil(i/o),c=Math.floor(r.width/o),d=Math.floor(r.height/s),l=r.isSubsampled?2:1,u=0;u<i;u++){var m=u%o*c,f=Math.floor(u/o)*d;r.sprites.push({id:u,x:m,y:f,width:c,height:d,sampledX:m/l,sampledY:f/l,sampledWidth:c/l,sampledHeight:d/l})}return r}function F(e,t,n,a){for(var r=a*t+n,i=0,o=null,s=null;s=e[i];){if(!(r>=s.sprites.length)){o=s.sprites[r];break}r-=s.sprites.length,i++}return{sprite:o,sheet:s}}function M(){}function X(e){for(var t=e.source,n="string"==typeof t?[t]:t,a=[],c=e.preloadCount||n.length,t=e.initiated||M,d=e.progress||M,m=e.complete||M,r=0,i=!1,o=!1,f=function(){r+=1,d({index:function(e,t){for(var n=0;n<t.length;n++)if(t[n]===e)return n}(this,a),loaded:r,total:n.length,percent:Math.round(r/n.length*100)}),(o=o||this===a[0])&&!i&&c<=r&&(i=!0,m(a))},s=0,l=n;s<l.length;s++){var h=l[s],u=new Image;a.push(u),u.crossOrigin=e.crossOrigin,u.onload=u.onabort=u.onerror=f,u.src=h}t(a)}function T(e,t,n){for(var a=String(e);a.length<t;)a=String(n)+a;return a}function Y(e,t){for(var n=t.digits||2,c=t.lanePlacer||"{lane}",d=t.framePlacer||"{frame}",a=0,r=0,i=(t.frame&&(a=t.frame[0],r=t.frame[1]),0),o=0,s=(t.lane&&(i=t.lane[0],o=t.lane[1]),[]),l=i;l<=o;l+=1)for(var u=a;u<=r;u+=1)s.push(e.replace(c,T(l,n,"0")).replace(d,T(u,n,"0")));return s}var i="spritespin",z=["mousedown","mousemove","mouseup","mouseenter","mouseover","mouseleave","mousewheel","wheel","click","dblclick","touchstart","touchmove","touchend","touchcancel","selectstart","gesturestart","gesturechange","gestureend"],C=["onInit","onProgress","onLoad","onFrameChanged","onFrame","onDraw","onComplete","onDestroy"],P=["dragstart"],B={source:void 0,width:void 0,height:void 0,frames:void 0,framesX:void 0,lanes:1,sizeMode:void 0,renderer:"canvas",lane:0,frame:0,frameTime:40,animate:!0,retainAnimate:!1,reverse:!1,loop:!0,stopFrame:0,wrap:!0,wrapLane:!1,sense:1,senseLane:void 0,orientation:"horizontal",detectSubsampling:!0,preloadCount:void 0,touchScrollTimer:[200,1500],responsive:void 0,plugins:void 0};function A(){}function E(e){return console&&console[e]?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return console.log.apply(console,e)}:A}var R=E("log"),D=E("warn"),W=E("error");function I(e){return Array.isArray(e)?e:[e]}function H(e,t,n){return n<e?n:e<t?t:e}function L(e,t,n,a){for(;n<e;)e-=a;for(;e<t;)e+=a;return e}function _(e){return e.preventDefault(),!1}function O(t,e,n){n&&t.bind(e+"."+i,function(e){n.apply(t,[e,t.spritespin("data")])})}function N(e){e.unbind("."+i)}function q(e){return(window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1)}function j(e){e.target.attr("unselectable","on").css({width:"",height:"","-ms-user-select":"none","-moz-user-select":"none","-khtml-user-select":"none","-webkit-user-select":"none","user-select":"none"});var t=(e.responsive?w:v)(e),n=x(e.sizeMode,b(e),t);e.target.css({width:t.width,height:t.height,position:"relative",overflow:"hidden"}),e.stage.css(n).hide(),e.canvas&&(e.canvas.css(n).hide(),e.canvasRatio=e.canvasRatio||q(e.context),"number"==typeof n.width&&"number"==typeof n.height?(e.canvas[0].width=n.width*e.canvasRatio||t.width,e.canvas[0].height=n.height*e.canvasRatio||t.height):(e.canvas[0].width=t.width*e.canvasRatio,e.canvas[0].height=t.height*e.canvasRatio),e.context.scale(e.canvasRatio,e.canvasRatio))}function U(e,t){return e.state=e.state||{},e.state[t]=e.state[t]||{},e.state[t]}function t(e,t){e=U(e,"plugin");return e[t]=e[t]||{},e[t]}function l(e,t){return!!U(e,"flags")[t]}function Q(e,t,n){U(e,"flags")[t]=!!n}function o(e){return U(e,"playback")}function Z(e){var t;o(e).handler&&(G(e),(t=e).frame+=t.reverse?-1:1,t.frame=L(t.frame,0,t.frames-1,t.frames),t.loop||t.frame!==t.stopFrame||K(t),J(e))}function G(e){var t=o(e);t.lastFrame=e.frame,t.lastLane=e.lane}function J(e){var t=o(e);t.lastFrame===e.frame&&t.lastLane===e.lane||e.target.trigger("onFrameChanged."+i,e),e.target.trigger("onFrame."+i,e),e.target.trigger("onDraw."+i,e)}function u(e,t,n){var a;G(e),null!=t&&((a=e).frame=Number(t),a.frame=a.wrap?L(a.frame,0,a.frames-1,a.frames):H(a.frame,0,a.frames-1)),null!=n&&(t=n,(a=e).lane=a.wrapLane?L(t,0,a.lanes-1,a.lanes):H(t,0,a.lanes-1)),J(e)}function K(e){e.animate=!1;e=o(e);null!=e.handler&&(window.clearInterval(e.handler),e.handler=null)}function h(e){var t=o(e);!t.handler||e.animate&&t.frameTime===e.frameTime||K(e),e.animate&&!t.handler&&(t.frameTime=e.frameTime,t.handler=window.setInterval(function(){return Z(e)},t.frameTime))}function V(e){e.animate=!0,h(e)}var ee={};function n(e,t){if(!ee[e])return ee[e]=t=t||{};W('Plugin name "'+e+'" is already taken')}function te(e){return ee[e]}function ne(e){var t=e;t.mods&&(D('"mods" option is deprecated, use "plugins" instead'),t.plugins=t.mods,delete t.mods),t.behavior&&(D('"behavior" option is deprecated, use "plugins" instead'),t.plugins.push(t.behavior),delete t.behavior),t.module&&(D('"module" option is deprecated, use "plugins" instead'),t.plugins.push(t.module),delete t.module);for(var n=0;n<e.plugins.length;n+=1){var a,r=e.plugins[n];"string"==typeof r&&((a=te(r))?e.plugins[n]=a:W("No plugin found with name "+r))}}var ae=d,re=0,ie={};function oe(e){for(var t in ie)ie.hasOwnProperty(t)&&e(ie[t])}var se=function(){function e(){oe(function(e){e.responsive&&ue(e)})}se=function(){};for(var t=function(t){ae(window.document).bind(t+"."+i,function(e){var r,i;r="document"+t,i=e,oe(function(e){for(var t=0,n=e.plugins;t<n.length;t++){var a=n[t];"function"==typeof a[r]&&a[r].apply(e.target,[i,e])}})})},n=0,a=z;n<a.length;n++)t(a[n]);var r=null;ae(window).on("resize",function(){window.clearTimeout(r),r=window.setTimeout(e,100)})};function le(e){var t=e.target;N(t);for(var n=0,a=P;n<a.length;n++)O(t,l=a[n],_);for(var r=0,i=e.plugins;r<i.length;r++){for(var c=i[r],o=0,d=z;o<d.length;o++)O(t,l=d[o],c[l]);for(var s=0,m=C;s<m.length;s++)O(t,l=m[s],c[l])}O(t,"onLoad",function(e,t){h(t)});for(var l,u=0,f=C;u<f.length;u++)O(t,l=f[u],e[l])}function ue(n){ne(n),le(n),j(n),n.source=I(n.source),n.loading=!0,n.target.addClass("loading").trigger("onInit."+i,n),X({source:n.source,crossOrigin:n.crossOrigin,preloadCount:n.preloadCount,progress:function(e){n.progress=e,n.target.trigger("onProgress."+i,n)},complete:function(e){var t;n.images=e,n.loading=!1,n.frames=n.frames||e.length,(e=n).images||(e.metrics=[]),e.metrics=S(e.images,e),(t=F(e.metrics,e.frames,0,0)).sprite&&(e.frameWidth=t.sprite.width,e.frameHeight=t.sprite.height),j(n),n.stage.show(),n.target.removeClass("loading").trigger("onLoad."+i,n).trigger("onFrame."+i,n).trigger("onDraw."+i,n).trigger("onComplete."+i,n)}})}function ce(e){var t=this,n=e.target,a=ae.extend(!0,{},B,e);return a.source=a.source||[],a.plugins=a.plugins||["360","drag"],n.find("img").each(function(){Array.isArray(a.source)||(a.source=[]),a.source.push(ae(t).attr("src"))}),n.empty().addClass("spritespin-instance").append("<div class='etheme-360-product-viewer-stage'></div>"),"canvas"===a.renderer&&((e=document.createElement("canvas")).getContext&&e.getContext("2d")?(a.canvas=ae(e).addClass("etheme-360-product-viewer-canvas"),a.context=e.getContext("2d"),n.append(a.canvas),n.addClass("with-canvas")):a.renderer="image"),a.target=n,a.stage=n.find(".etheme-360-product-viewer-stage"),n.data(i,a),re+=1,(e=a).id=String(re),ie[e.id]=e,a}function de(e){se();var t=e.target.data(i);return t?ae.extend(t,e):t=ce(e),ue(t),t}function me(e){delete ie[e.id],K(e),e.target.trigger("onDestroy",e).html(null).attr("style",null).attr("unselectable",null).removeClass(["spritespin-instance","with-canvas"]),N(e.target),e.target.removeData(i)}function fe(e){return U(e,"input")}function he(e,t){var e=g(e),n=fe(t);n.oldX=n.currentX,n.oldY=n.currentY,n.currentX=e.x,n.currentY=e.y,void 0!==n.oldX&&void 0!==n.oldY||(n.oldX=n.currentX,n.oldY=n.currentY),void 0!==n.startX&&void 0!==n.startY||(n.startX=n.currentX,n.startY=n.currentY,n.clickframe=t.frame,n.clicklane=t.lane),n.dX=n.currentX-n.startX,n.dY=n.currentY-n.startY,n.ddX=n.currentX-n.oldX,n.ddY=n.currentY-n.oldY,n.ndX=n.dX/t.target.innerWidth(),n.ndY=n.dY/t.target.innerHeight(),n.nddX=n.ddX/t.target.innerWidth(),n.nddY=n.ddY/t.target.innerHeight()}function ge(e){e=fe(e);e.startX=e.startY=void 0,e.currentX=e.currentY=void 0,e.oldX=e.oldY=void 0,e.dX=e.dY=0,e.ddX=e.ddY=0,e.ndX=e.ndY=0,e.nddX=e.nddY=0}function pe(e,t){for(var n=0,a=t;n<a.length;n++){var r=a[n];if(e[r]||r in e)return r}return t[0]}d.fn[i]=function(e,t){var n,a=d(this);if("data"===e)return a.data(i);if("api"===e)return(n=a.data(i)).api=n.api||new r(n),n.api;if("destroy"===e)return a.each(function(){var e=a.data(i);e&&me(e)});if(2===arguments.length&&"string"==typeof e&&((n={})[e]=t,e=n),"object"==typeof e)return de(d.extend(!0,{target:a},e)).target;throw new Error("Invalid call to spritespin")},a({isPlaying:function(){return null!=o(this.data).handler},isLooping:function(){return this.data.loop},toggleAnimation:function(){this.isPlaying()?this.stopAnimation():this.startAnimation()},stopAnimation:function(){this.data.animate=!1,K(this.data)},startAnimation:function(){this.data.animate=!0,h(this.data)},loop:function(e){return this.data.loop=e,h(this.data),this},currentFrame:function(){return this.data.frame},updateFrame:function(e){return u(this.data,e),this},skipFrames:function(e){var t=this.data;return u(t,t.frame+(t.reverse?-e:+e)),this},nextFrame:function(){return this.skipFrames(1)},prevFrame:function(){return this.skipFrames(-1)},playTo:function(e,t){var n,a=this.data;if((t=t||{}).force||a.frame!==e)return t.nearest&&(t=e-a.frame,n=e>a.frame?t-a.frames:t+a.frames,t=Math.abs(t)<Math.abs(n)?t:n,a.reverse=t<0),a.animate=!0,a.loop=!1,a.stopFrame=e,h(a),this}});var ve={requestFullscreen:pe(document.documentElement,["requestFullscreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen"]),exitFullscreen:pe(document,["exitFullscreen","webkitExitFullscreen","webkitCancelFullScreen","mozCancelFullScreen","msExitFullscreen"]),fullscreenElement:pe(document,["fullscreenElement","webkitFullscreenElement","webkitCurrentFullScreenElement","mozFullScreenElement","msFullscreenElement"]),fullscreenEnabled:pe(document,["fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled"]),fullscreenchange:pe(document,["onfullscreenchange","onwebkitfullscreenchange","onmozfullscreenchange","onMSFullscreenChange"]).replace(/^on/,""),fullscreenerror:pe(document,["onfullscreenerror","onwebkitfullscreenerror","onmozfullscreenerror","onMSFullscreenError"]).replace(/^on/,"")},we=ve.fullscreenchange+"."+i+"-fullscreen";function be(){d(document).unbind(we)}var xe,ye,Se,ke,Fe,Me,Xe,Te,Ye,ze,Ce,$e,Pe="orientationchange."+i+"-fullscreen";function Be(){d(window).unbind(Pe)}function Ae(){return document[ve.fullscreenElement]}function Ee(t,e){e=e||{};function n(){t.width=window.screen.width,t.height=window.screen.height,t.source=e.source||o,t.sizeMode=e.sizeMode||"fit",t.responsive=!1,ue(t)}var a,r=t.width,i=t.height,o=t.source,s=t.sizeMode,l=t.responsive;a=function(){var e;Ae()?(n(),e=n,Be(),d(window).bind(Pe,e)):(be(),Be(),t.width=r,t.height=i,t.source=o,t.sizeMode=s,t.responsive=l,ue(t))},be(),d(document).bind(we,a),(t.target[0]||document.documentElement)[ve.requestFullscreen]()}function Re(e,t){var n,a,r;!t.loading&&t.stage.is(":visible")&&(he(e,t),e=fe(t),a=(r=t.target).offset(),r="horizontal"===t.orientation?(n=r.innerWidth()/2,e.currentX-a.left):(n=r.innerHeight()/2,e.currentY-a.top),u(t,t.frame+(n<r?1:-1)))}function De(e){return t(e,xe)}function We(e,t){var n=De(t),a=[200,1500],t=t.touchScrollTimer||a;n.minTime=t[0]||a[0],n.maxTime=t[1]||a[1]}function Ie(e,t){var n,a=De(t);t.loading||l(t,"dragging")||t.zoomPinFrame&&!t.stage.is(":visible")||(n=(new Date).getTime(),a.endAt&&n-a.endAt>a.maxTime&&(a.startAt=null,a.endAt=null),a.startAt&&n-a.startAt>a.minTime&&e.preventDefault(),a.startAt=n,a.wasPlaying=!!o(t).handler,a.frame=t.frame||0,a.lane=t.lane||0,Q(t,"dragging",!0),he(e,t))}function He(e,t){l(t,"dragging")&&(De(t).endAt=(new Date).getTime(),Q(t,"dragging",!1),ge(t),t.retainAnimate&&De(t).wasPlaying&&V(t))}function Le(e,t){var n,a,r=De(t),i=fe(t);l(t,"dragging")&&(he(e,t),e="number"==typeof(e=t).orientation?e.orientation*Math.PI/180:"horizontal"===e.orientation?0:Math.PI/2,a=Math.sin(e),e=Math.cos(e),n=(i.nddX*e-i.nddY*a)*t.sense||0,a=(i.nddX*a+i.nddY*e)*(t.senseLane||t.sense)||0,r.frame+=t.frames*n,r.lane+=t.lanes*a,t.frame,t.lane,u(t,Math.floor(r.frame),Math.floor(r.lane)),K(t))}function _e(e){return t(e,ye)}function Oe(e,t){var n,a;l(t,"loading")||l(t,"dragging")||!t.stage.is(":visible")||((a=_e(n=t)).frameTime=n.frameTime,a.animate=n.animate,a.reverse=n.reverse,he(e,t),Q(t,"dragging",!0),t.animate=!0,h(t))}function Ne(e,t){var n,a;Q(t,"dragging",!1),ge(t),K(t),a=_e(n=t),n.frameTime=a.frameTime,n.animate=a.animate,n.reverse=a.reverse,h(t)}function qe(e,t){var n,a,r,i;l(t,"dragging")&&(he(e,t),n=fe(t),r=(i=t.target).offset(),i="horizontal"===t.orientation?(a=i.innerWidth()/2,(n.currentX-r.left-a)/a):(a=t.height/2,(n.currentY-r.top-a)/a),t.reverse=i<0,t.frameTime=80*(1-(i=i<0?-i:i))+20,("horizontal"===t.orientation&&n.dX<n.dY||"vertical"===t.orientation&&n.dX<n.dY)&&e.preventDefault())}function je(e){return t(e,Se)}function Ue(e,t,n){return e[t]||n}function Qe(e,t){t.loading||l(t,"dragging")||(he(e,t),Q(t,"dragging",!0))}function Ze(e,t){l(t,"dragging")&&(he(e,t),u(t,t.frame,t.lane))}function Ge(e,t){var n,a,r,i,o,s;l(t,"dragging")&&(Q(t,"dragging",!1),i=je(t),s=fe(t),n=t.frame,a=t.lane,r=i.snap,i=i.fling,s="horizontal"===t.orientation?(o=s.ndX,s.ddX):(o=s.ndY,s.ddY),r<=o||i<=s?n=t.frame-1:(o<=-r||s<=-i)&&(n=t.frame+1),ge(t),u(t,n,a),K(t))}function Je(e){return t(e,ke)}function Ke(e){return t(e,Fe)}function Ve(e,t,n){return e[t]||n}function et(o){var e=Ke(o);e.timeout=window.setTimeout(function(){var e=o,t=Ke(e);if(tt(e),t.context){var n=0;!function(e,t){t.canvas.show();t.canvas[0].width,e.canvasRatio,t.canvas[0].height,e.canvasRatio}(e,t),t.context.clearRect(0,0,e.width,e.height);for(var a=0,r=t.steps;a<r.length;a++){var i=r[a];i.live=Math.max(i.live-i.step,0),i.alpha=Math.max(i.live-.25,0),function(e,t,n){var a,r,i;n.alpha<=0||(a=F(e.metrics,e.frames,n.frame,n.lane),r=a.sheet,a=a.sprite,r&&a&&(e.source[r.id],!1!==(r=e.images[r.id]).complete&&(t.canvas.show(),i=t.canvas[0].width/e.canvasRatio,e=t.canvas[0].height/e.canvasRatio,t.context.globalAlpha=n.alpha,t.context.drawImage(r,a.sampledX,a.sampledY,a.sampledWidth,a.sampledHeight,0,0,i,e))))}(e,t,i),n+=i.alpha+i.d}t.cssBlur&&!function(e,t){t="blur("+Math.min(Math.max(t/2-4,0),2.5)+"px)";e.css({"-webkit-filter":t,filter:t})}(t.canvas,n),function(e){for(var t=Me.length=0;t<e.length;t+=1)e[t].alpha<=0&&Me.push(t);for(var n=0,a=Me;n<a.length;n++){var r=a[n];e.splice(r,1)}}(t.steps),t.steps.length&&et(e)}},e.frameTime)}function tt(e){e=Ke(e);window.clearTimeout(e.timeout),e.timeout=null}function nt(e){return t(e,Ye)}function at(e,t,n){return e[t]||n}function rt(e,t){if(l(t,"dragging")){ot(t);var n=nt(t);for(n.samples.push({time:(new Date).getTime(),frame:t.frame,lane:t.lane});n.samples.length>n.maxSamples;)n.samples.shift()}}function it(c,e){for(var t,n=nt(e),a=n.samples,r=0,i=0,o=0,s=0,l=a;s<l.length;s++){var u=l[s];if(t){var d=u.time-t.time;if(d>n.abortTime)return r=i=o=0,ot(e);i+=u.frame-t.frame,r+=u.lane-t.lane,o+=d,t=u}else t=u}a.length=0,o&&(n.lane=e.lane,n.lanes=0,n.laneStep=r/o*n.updateTime,n.frame=e.frame,n.frames=0,n.frameStep=i/o*n.updateTime,st(e))}function ot(e){e=nt(e);null!=e.handler&&(window.clearTimeout(e.handler),e.handler=null)}function st(r){var e=nt(r);e.handler=window.setTimeout(function(){var e,t,n,a;(t=nt(e=r)).lanes+=t.laneStep,t.frames+=t.frameStep,t.laneStep*=t.damping,t.frameStep*=t.damping,n=Math.floor(t.frame+t.frames),a=Math.floor(t.lane+t.lanes),u(e,n,a),(!l(e,"dragging")&&(.005<Math.abs(t.frameStep)||.005<Math.abs(t.laneStep))?st:ot)(e)},e.updateTime)}function lt(e){return t(e,ze)}function ut(e,t,n){return e[t]||n}function ct(e){return t(e,Ce)}function c(e){return t(e,$e)}function dt(e,t,n){return t in e?e[t]:n}function mt(e,t){var n,a,r,i,o=c(t);o.stage.is(":visible")&&(e.preventDefault(),o.pinFrame&&Q(t,"dragging",!1),n=(a=g(e)).x/t.width,a=a.y/t.height,null==o.oldX&&(o.oldX=n,o.oldY=a),null==o.currentX&&(o.currentX=n,o.currentY=a),r=n-o.oldX,i=a-o.oldY,o.oldX=n,o.oldY=a,e.type.match(/touch/)&&(r=-r,i=-i),o.currentX=H(o.currentX+r,0,1),o.currentY=H(o.currentY+i,0,1),u(t,t.frame,t.lane))}function ft(e,t){var n,a=c(t);a.useClick&&(e.preventDefault(),n=(new Date).getTime(),!a.clickTime||n-a.clickTime>a.doubleClickTime?a.clickTime=n:(a.clickTime=void 0,gt(t)&&mt(e,t)))}function ht(e,t){c(t).stage.is(":visible")&&mt(e,t)}function gt(e){var t=c(e);if(!t.stage)throw new Error("zoom module is not initialized or is not available.");if(!t.stage.is(":visible"))return vt(e),1;pt(e)}function pt(e){c(e).stage.fadeOut(),e.stage.fadeIn()}function vt(e){c(e).stage.fadeIn(),e.stage.fadeOut()}a({fullscreenEnabled:function(){return document[ve.fullscreenEnabled]},fullscreenElement:Ae,exitFullscreen:function(){return document[ve.exitFullscreen]()},toggleFullscreen:function(e){!function(e){Ae()?this.apiRequestFullscreen(e):this.exitFullscreen()}((this.data,e))},requestFullscreen:function(e){Ee(this.data,e)}}),n("click",{name:"click",mouseup:Re,touchend:Re}),n(xe="drag",{name:"drag",onInit:We,mousedown:Ie,mousemove:Le,mouseup:He,documentmousemove:Le,documentmouseup:He,touchstart:Ie,touchmove:Le,touchend:He,touchcancel:He}),n("move",{name:"move",onInit:We,mousemove:function(e,t){Ie(e,t),Le(e,t)},mouseleave:He,touchstart:Ie,touchmove:Le,touchend:He,touchcancel:He}),n(ye="hold",{name:ye,mousedown:Oe,mousemove:qe,mouseup:Ne,mouseleave:Ne,touchstart:Oe,touchmove:qe,touchend:Ne,touchcancel:Ne,onFrame:function(e,t){t.animate=!0,h(t)}}),n(Se="swipe",{name:Se,onLoad:function(e,t){var n=je(t);n.fling=Ue(t,"swipeFling",10),n.snap=Ue(t,"swipeSnap",.5)},mousedown:Qe,mousemove:Ze,mouseup:Ge,mouseleave:Ge,touchstart:Qe,touchmove:Ze,touchend:Ge,touchcancel:Ge}),n("wheel",{name:"wheel",wheel:function(e,t){var n;!t.loading&&t.stage.is(":visible")&&(e.preventDefault(),n=0===(e=e.originalEvent).deltaX?0:0<e.deltaX?1:-1,e=0===e.deltaY?0:0<e.deltaY?1:-1,u(t,t.frame+e,t.lane+n))}}),n(ke="progress",{name:ke,onInit:function(e,t){var n=Je(t);n.stage||(n.stage=d("\n<div class='etheme-360-product-viewer-progress'>\n  <div class='etheme-360-product-viewer-progress-label'></div>\n  <div class='etheme-360-product-viewer-progress-bar'></div>\n</div>\n"),n.stage.appendTo(t.target)),n.stage.find(".etheme-360-product-viewer-progress-label").text("0%").css({"text-align":"center"}),n.stage.find(".etheme-360-product-viewer-progress-bar").css({width:"0%"}),n.stage.hide().fadeIn()},onProgress:function(e,t){var n=Je(t);n.stage.find(".etheme-360-product-viewer-progress-label").text(t.progress.percent+"%").css({"text-align":"center"}),n.stage.find(".etheme-360-product-viewer-progress-bar").css({width:t.progress.percent+"%"})},onLoad:function(e,t){d(Je(t).stage).fadeOut()},onDestroy:function(e,t){d(Je(t).stage).remove()}}),n("360",{name:"360",onLoad:function(e,t){t.stage.find(".spritespin-frames").detach(),"image"===t.renderer&&$(t.images).addClass("spritespin-frames").appendTo(t.stage)},onDraw:function(e,t){var n=(a=F(t.metrics,t.frames,t.frame,t.lane)).sheet,a=a.sprite;if(n&&a){var r=t.source[n.id],i=t.images[n.id];if("canvas"===t.renderer)return t.canvas.show(),o=t.canvas[0].width/t.canvasRatio,s=t.canvas[0].height/t.canvasRatio,t.context.clearRect(0,0,o,s),void t.context.drawImage(i,a.sampledX,a.sampledY,a.sampledWidth,a.sampledHeight,0,0,o,s);var o=t.stage.innerWidth()/a.sampledWidth,s=t.stage.innerHeight()/a.sampledHeight,l=Math.floor(-a.sampledY*s),a=Math.floor(-a.sampledX*o),o=Math.floor(n.sampledWidth*o),n=Math.floor(n.sampledHeight*s);"background"!==t.renderer?($(t.images).hide(),$(i).show().css({position:"absolute",top:l,left:a,"max-width":"initial",width:o,height:n})):t.stage.css({"background-image":"url('"+r+"')","background-position":a+"px "+l+"px","background-repeat":"no-repeat","-webkit-background-size":o+"px "+n+"px","-moz-background-size":o+"px "+n+"px","-o-background-size":o+"px "+n+"px","background-size":o+"px "+n+"px"})}}}),Me=[],n(Fe="blur",{name:Fe,onLoad:function(e,t){var n=Ke(t),a=(n.canvas=n.canvas||d("<canvas class='blur-layer'></canvas>"),n.context=n.context||n.canvas[0].getContext("2d"),n.steps=n.steps||[],n.fadeTime=Math.max(Ve(t,"blurFadeTime",200),1),n.frameTime=Math.max(Ve(t,"blurFrameTime",t.frameTime),16),n.trackTime=null,n.cssBlur=!!Ve(t,"blurCss",!1),b(t)),r=(t.responsive?w:v)(t),a=x(t.sizeMode,a,r);n.canvas[0].width=t.width*t.canvasRatio,n.canvas[0].height=t.height*t.canvasRatio,n.canvas.css(a).show(),n.context.scale(t.canvasRatio,t.canvasRatio),t.target.append(n.canvas)},onFrameChanged:function(e,t){var n,a,r,i=Ke(t);a=Ke(n=t),r=o(n),r=(r=Math.abs(n.frame-r.lastFrame))>=n.frames/2?n.frames-r:r,a.steps.unshift({frame:n.frame,lane:n.lane,live:1,step:a.frameTime/a.fadeTime,d:r,alpha:0}),null==i.timeout&&et(t)}}),Xe=Math.max,Te=Math.min,n(Ye="ease",{name:Ye,onLoad:function(e,t){var n=nt(t);n.maxSamples=Xe(at(t,"easeMaxSamples",5),0),n.damping=Xe(Te(at(t,"easeDamping",.9),.999),0),n.abortTime=Xe(at(t,"easeAbortTime",250),16),n.updateTime=Xe(at(t,"easeUpdateTime",t.frameTime),16),n.samples=[],n.steps=[]},mousemove:rt,mouseup:it,mouseleave:it,touchmove:rt,touchend:it,touchcancel:it}),n(ze="gallery",{name:ze,onLoad:function(c,e){for(var t=lt(e),n=(t.images=[],t.offsets=[],t.frame=e.frame,t.speed=ut(e,"gallerySpeed",500),t.opacity=ut(e,"galleryOpacity",.25),t.stage=ut(e,"galleryStage",d("<div></div>")),t.stage.empty().addClass("gallery-stage").prependTo(e.stage),0),a=0,r=e.images;a<r.length;a++){var i=r[a],o=y(i),o=e.height/o.height,s=d(i);t.stage.append(s),t.images.push(s),t.offsets.push(-n+(e.width-i.width*o)/2),n+=e.width,s.css({"max-width":"initial",opacity:t.opacity,width:e.width,height:e.height})}var l=b(e),u=(e.responsive?w:v)(e),l=x(e.sizeMode,l,u);t.stage.css(l).css({width:n,left:t.offsets[t.frame]}),t.images[t.frame].animate({opacity:1},{duration:t.speed})},onDraw:function(e,t){var n=lt(t),a=fe(t),r=l(t,"dragging");n.frame===t.frame||r?!r&&n.dX===a.dX||(n.dX=a.dX,n.ddX=a.ddX,n.stage.stop(!0,!0).css({left:n.offsets[n.frame]+n.dX})):(n.stage.stop(!0,!1).animate({left:n.offsets[t.frame]},{duration:n.speed}),n.images[n.frame].animate({opacity:n.opacity},{duration:n.speed}),n.frame=t.frame,n.images[n.frame].animate({opacity:1},{duration:n.speed}),n.stage.animate({left:n.offsets[n.frame]}))}}),n(Ce="panorama",{name:Ce,onLoad:function(e,t){var n,a=ct(t),r=t.metrics[0];r&&("horizontal"===t.orientation?(a.scale=t.target.innerHeight()/r.sampledHeight,t.frames=r.sampledWidth):(a.scale=t.target.innerWidth()/r.sampledWidth,t.frames=r.sampledHeight),n=Math.floor(r.sampledWidth*a.scale),a=Math.floor(r.sampledHeight*a.scale),t.stage.css({"background-image":"url("+t.source[r.id]+")","background-repeat":"repeat-both","-webkit-background-size":n+"px "+a+"px","-moz-background-size":n+"px "+a+"px","-o-background-size":n+"px "+a+"px","background-size":n+"px "+a+"px"}))},onDraw:function(e,t){var n=ct(t),a=(i="horizontal"===t.orientation?1:0)?0:1,r=t.frame%t.frames,i=Math.round(i*r*n.scale),a=Math.round(a*r*n.scale);t.stage.css({"background-position":i+"px "+a+"px"})}}),n($e="zoom",{name:$e,mousedown:ft,touchstart:ft,mousemove:ht,touchmove:ht,wheel:function(e,t){var n,a=c(t);!t.loading&&a.useWheel&&(n=0===(n=e.originalEvent).deltaY?0:0<n.deltaY?1:-1,"number"==typeof a.useWheel&&(n*=a.useWheel),a.stage.is(":visible")&&0<n&&(e.preventDefault(),pt(t)),!a.stage.is(":visible")&&n<0&&(e.preventDefault(),vt(t)))},onInit:function(e,t){var n=c(t);n.source=dt(t,"zoomSource",t.source),n.useWheel=dt(t,"zoomUseWheel",!1),n.useClick=dt(t,"zoomUseClick",!0),n.pinFrame=dt(t,"zoomPinFrame",!0),n.doubleClickTime=dt(t,"zoomDoubleClickTime",500),n.stage=n.stage||d("<div class='zoom-stage'></div>"),n.stage.css({width:"100%",height:"100%",top:0,left:0,bottom:0,right:0,position:"absolute"}).appendTo(t.target).hide()},onDestroy:function(e,t){(t=c(t)).stage&&(t.stage.remove(),delete t.stage)},onDraw:function(e,t){var n,a=c(t),r=t.lane*t.frames+t.frame,r=a.source[r],i=F(t.metrics,t.frames,t.frame,t.lane),o=a.currentX,s=a.currentY;null==o&&(o=a.currentX=.5,s=a.currentY=.5),r?(o=Math.floor(100*o),s=Math.floor(100*s),a.stage.css({"background-repeat":"no-repeat","background-image":"url('"+r+"')","background-position":o+"% "+s+"%"})):i.sheet&&i.sprite&&(r=i.sprite,i=i.sheet,n=t.source[i.id],o=-Math.floor(r.sampledX+o*(r.sampledWidth-t.width)),s=-Math.floor(r.sampledY+s*(r.sampledHeight-t.height)),r=i.sampledWidth,t=i.sampledHeight,a.stage.css({"background-image":"url('"+n+"')","background-position":o+"px "+s+"px","background-repeat":"no-repeat","-webkit-background-size":r+"px "+t+"px","-moz-background-size":r+"px "+t+"px","-o-background-size":r+"px "+t+"px","background-size":r+"px "+t+"px"}))}}),a({toggleZoom:function(){gt(this.data)}}),e.Utils={$:d,bind:O,clamp:H,detectSubsampling:p,error:W,findSpecs:F,getComputedSize:w,getCursorPosition:g,getInnerLayout:x,getInnerSize:b,getOuterSize:v,isFunction:function(e){return"function"==typeof e},log:R,measure:S,naturalSize:y,noop:A,pixelRatio:q,preload:X,prevent:_,sourceArray:Y,toArray:I,unbind:N,warn:D,wrap:L},e.sourceArray=Y,e.Api=r,e.extendApi=a,e.instances=ie,e.applyEvents=le,e.boot=ue,e.create=ce,e.createOrUpdate=de,e.destroy=me,e.namespace=i,e.eventNames=z,e.callbackNames=C,e.eventsToPrevent=P,e.defaults=B,e.getInputState=fe,e.updateInput=he,e.resetInput=ge,e.applyLayout=j,e.getPlaybackState=o,e.updateFrame=u,e.stopAnimation=K,e.applyAnimation=h,e.startAnimation=V,e.registerPlugin=n,e.registerModule=function(e,t){D('"registerModule" is deprecated, use "registerPlugin" instead'),n(e,t)},e.getPlugin=te,e.applyPlugins=ne,e.getState=U,e.getPluginState=t,e.is=l,e.flag=Q,Object.defineProperty(e,"__esModule",{value:!0})}),function(){"use strict";jQuery(window).on("elementor/frontend/init",function(){var t=elementorModules.frontend.handlers.Base.extend({onInit:function(){elementorModules.frontend.handlers.Base.prototype.onInit.apply(this,arguments),this.run()},getDefaultSettings:function(){return{selectors:{wrapper:".etheme-360-product-viewer-wrapper",images:".etheme-360-product-viewer-images",progress:".etheme-360-product-viewer-progress",navBar:".etheme-360-product-viewer-nav",navBarPrevious:".etheme-360-product-viewer-nav-previous",navBarPlay:".etheme-360-product-viewer-nav-play",navBarStop:".etheme-360-product-viewer-nav-stop",navBarNext:".etheme-360-product-viewer-nav-next",fullScreenButton:".etheme-360-product-viewer-full-screen-button"}}},getDefaultElements:function(){var e=this.getSettings("selectors");return{$wrapper:this.$element.find(e.wrapper),$images:this.$element.find(e.images),$progress:this.$element.find(e.progress),$navBar:this.$element.find(e.navBar),$navBarPrevious:this.$element.find(e.navBarPrevious),$navBarPlay:this.$element.find(e.navBarPlay),$navBarStop:this.$element.find(e.navBarStop),$navBarNext:this.$element.find(e.navBarNext),$fullScreenButton:this.$element.find(e.fullScreenButton)}},navigationState:function(e=!0){e?(this.elements.$navBarNext.removeClass("disabled"),this.elements.$navBarPrevious.removeClass("disabled"),this.elements.$navBarStop.addClass("hidden"),this.elements.$navBarPlay.removeClass("hidden")):(this.elements.$navBarNext.addClass("disabled"),this.elements.$navBarPrevious.addClass("disabled"),this.elements.$navBarStop.removeClass("hidden"),this.elements.$navBarPlay.addClass("hidden"))},initTwentySixty:function(){var a=this.getElementSettings();if(this.elements.$wrapper.length){var r=this.elements.$wrapper.data("settings");if(r.images.length){this.elements.$wrapper.attr("data-settings",null);var i=new Map;i.set("source",r.images),i.set("source_type","local");let e=["360","progress"],t=(a.mouse_option&&e.push(a.mouse_option),a.ease&&e.push("ease"),i.set("plugins",e),i.set("animate",!!a.autoplay),i.set("loop",!!a.loop),i.set("responsive",!0),i.set("retain_animate",!0),a.frame_time&&i.set("frameTime",a.frame_time),i.set("reverse",!!a.reverse),this.elements.$images.spritespin(Object.fromEntries(i)),this),n=t.elements.$images.spritespin("api");t.elements.$images.on("onComplete.spritespin",function(){t.elements.$images.removeClass("spritespin-instance"),t.elements.$navBar.removeClass("hidden"),t.elements.$fullScreenButton.removeClass("hidden"),"drag"==a.mouse_option&&t.elements.$images.css({cursor:"grab"})}),a.pause_on_hover&&t.elements.$images.on("mouseover",function(){n.data.animate&&n.stopAnimation()}),a.start_on_leave&&t.elements.$images.on("mouseleave",function(){n.data.animate||n.startAnimation()}),this.elements.$navBarPrevious.on("click",function(){n.prevFrame()}),this.elements.$navBarNext.on("click",function(){n.nextFrame()}),this.elements.$navBarPlay.on("click",function(){t.navigationState(!1),n.startAnimation()}),this.elements.$navBarStop.on("click",function(){t.navigationState(!0),n.stopAnimation()}),this.elements.$fullScreenButton.on("click",function(){n.requestFullscreen()})}}},run:function(){elementorFrontend.waypoint(this.$element,()=>this.initTwentySixty(),{offset:"bottom-in-view"})}});elementorFrontend.hooks.addAction("frontend/element_ready/etheme_three_sixty_product_viewer.default",function(e){elementorFrontend.elementsHandler.addHandler(t,{$element:e})})})}();